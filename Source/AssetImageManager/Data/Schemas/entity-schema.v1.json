{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://vtttools.com/schemas/entity-schema.v1.json",
  "title": "VTTTools Entity Definition Schema",
  "description": "Schema for validating entity definitions with cartesian product variants",
  "oneOf": [
    {
      "type": "object",
      "$ref": "#/$defs/EntityDefinition"
    },
    {
      "type": "array",
      "items": {
        "$ref": "#/$defs/EntityDefinition"
      },
      "minItems": 1
    }
  ],
  "$defs": {
    "EntityDefinition": {
      "type": "object",
      "required": [
        "schemaVersion",
        "name",
        "category",
        "type",
        "subtype",
        "size",
        "physicalDescription",
        "alternatives"
      ],
      "additionalProperties": false,
      "properties": {
        "schemaVersion": {
          "type": "integer",
          "const": 1,
          "description": "Schema version for entity definition format"
        },
        "name": {
          "type": "string",
          "minLength": 1,
          "maxLength": 128,
          "pattern": "^[a-zA-Z0-9 ]+$",
          "description": "Entity name (alphanumeric characters and spaces only)"
        },
        "genre": {
          "type": ["string", "null"],
          "maxLength": 64,
          "pattern": "^[a-zA-Z0-9 ]+$",
          "description": "Optional genre classification (e.g., Fantasy, Sci-Fi, Horror, Steampunk). Defaults to 'Fantasy' if not provided."
        },
        "category": {
          "type": "string",
          "enum": ["creature", "object", "character"],
          "description": "Entity category classification"
        },
        "type": {
          "type": "string",
          "minLength": 1,
          "maxLength": 50,
          "description": "Entity type within category"
        },
        "subtype": {
          "type": "string",
          "minLength": 1,
          "maxLength": 50,
          "description": "Entity subtype classification"
        },
        "size": {
          "type": "string",
          "enum": ["tiny", "small", "medium", "large", "huge", "gargantuan"],
          "description": "Entity size classification"
        },
        "physicalDescription": {
          "type": "string",
          "minLength": 1,
          "maxLength": 2048,
          "description": "Detailed physical description of the entity"
        },
        "distinctiveFeatures": {
          "type": ["string", "null"],
          "maxLength": 1024,
          "description": "Optional distinctive features or characteristics"
        },
        "environment": {
          "type": ["string", "null"],
          "maxLength": 256,
          "description": "Optional typical environment or habitat"
        },
        "alternatives": {
          "type": ["array", "null"],
          "minItems": 1,
          "items": {
            "$ref": "#/$defs/AlternativeDefinition"
          },
          "description": "Array of alternative variant definitions (min 1 required) or null for no variants"
        }
      }
    },
    "AlternativeDefinition": {
      "type": "object",
      "additionalProperties": false,
      "anyOf": [
        { "required": ["gender"] },
        { "required": ["class"] },
        { "required": ["equipment"] },
        { "required": ["material"] },
        { "required": ["quality"] }
      ],
      "properties": {
        "gender": {
          "type": ["array", "null"],
          "minItems": 1,
          "uniqueItems": true,
          "items": {
            "type": "string",
            "pattern": "^[a-z]+$"
          },
          "description": "Optional gender variants (lowercase only)"
        },
        "class": {
          "type": ["array", "null"],
          "minItems": 1,
          "uniqueItems": true,
          "items": {
            "type": "string",
            "pattern": "^[a-z]+$"
          },
          "description": "Optional class variants (lowercase only)"
        },
        "equipment": {
          "type": ["array", "null"],
          "minItems": 1,
          "uniqueItems": true,
          "items": {
            "type": "string"
          },
          "description": "Optional equipment variants"
        },
        "armor": {
          "type": ["array", "null"],
          "minItems": 1,
          "uniqueItems": true,
          "items": {
            "type": "string"
          },
          "description": "Optional armor variants"
        },
        "material": {
          "type": ["array", "null"],
          "minItems": 1,
          "uniqueItems": true,
          "items": {
            "type": "string"
          },
          "description": "Optional material variants"
        },
        "quality": {
          "type": ["array", "null"],
          "minItems": 1,
          "uniqueItems": true,
          "items": {
            "type": "string"
          },
          "description": "Optional quality variants"
        }
      }
    }
  }
}
